"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthenticationGuard=void 0;const user_service_1=require("../../user/application/user.service");class AuthenticationGuard{static canActivate(e,t,s){const a=e.headers.authorization;if(!a)return t.status(401).send("Unauthorized");const r=a.split(" ");if(!(r.length>1&&"bearer"==r[0].toLocaleLowerCase()))return t.status(401).send("Unauthorized");user_service_1.UserService.validateAccessToken(r[1]).then((e=>{t.locals.payload=e,s()}),(e=>t.status(e.status).send(e.message)))}}exports.AuthenticationGuard=AuthenticationGuard;