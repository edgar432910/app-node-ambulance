"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthorizationGuard=void 0;class AuthorizationGuard{static canActivate(...t){return(e,o,a)=>{const{roles:r}=o.locals.payload,s=r.map((t=>t.actions)).reduce(((t,e)=>t+=e),"").split(","),i=[...new Set(s)];t.some((t=>i.includes(t)))?a():o.status(403).send("Forbidden")}}}exports.AuthorizationGuard=AuthorizationGuard;