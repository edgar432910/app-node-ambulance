"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const express_1=__importDefault(require("express")),user_route_1=__importDefault(require("./user/adapter/user.route")),driver_route_1=__importDefault(require("./driver/adapter/driver.route")),medic_route_1=__importDefault(require("./medic/adapter/medic.route")),role_route_1=__importDefault(require("./role/adapter/role.route")),auth_route_1=__importDefault(require("./auth/adapter/auth.route")),errors_helper_1=__importDefault(require("./shared/helpers/errors.helper")),multer_1=__importDefault(require("multer")),helmet_1=__importDefault(require("helmet")),permissions_policy_1=__importDefault(require("permissions-policy")),authentication_guard_1=require("./shared/guards/authentication.guard"),yenv_1=__importDefault(require("yenv")),env=(0,yenv_1.default)(),domain=env.DOMAIN;class App{constructor(){this.expressApp=(0,express_1.default)(),this.init(),this.mountMiddlewares(),this.mountRoutes(),this.mountErros()}init(){(0,multer_1.default)({limits:{fileSize:8e6}})}mountMiddlewares(){this.expressApp.use((0,helmet_1.default)()),this.expressApp.use((0,permissions_policy_1.default)({features:{geolocation:["self",`"${domain}"`],camera:["self",`"${domain}"`],microphone:["self",`"${domain}"`],notifications:["self",`"${domain}"`],push:["self",`"${domain}"`]}})),this.expressApp.use(express_1.default.urlencoded({extended:!0})),this.expressApp.use(express_1.default.json())}mountRoutes(){this.expressApp.get("/",((e,r)=>r.send("CODIGO COMPLETO before to test"))),this.expressApp.use("/users",user_route_1.default),this.expressApp.use("/drivers",authentication_guard_1.AuthenticationGuard.canActivate,driver_route_1.default),this.expressApp.use("/medics",medic_route_1.default),this.expressApp.use("/roles",role_route_1.default),this.expressApp.use("/auth",auth_route_1.default)}mountErros(){this.expressApp.use(errors_helper_1.default.notFound),this.expressApp.use(errors_helper_1.default.generic)}}exports.default=(new App).expressApp;